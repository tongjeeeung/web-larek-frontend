# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Базовый код

1. Класс EventEmitter

Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков
о наступлении события.
Класс имеет методы ```on ```, ```off``` ,```emit``` — для подписки на событие, отписки от события и уведомления
подписчиков о наступлении события соответственно.
Дополнительно реализованы методы ```onAll``` и ```offAll``` — для подписки на все события и сброса всех
подписчиков.
Интересным дополнением является метод ```trigger``` , генерирующий заданное событие с заданными
аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти
классы будут генерировать события, не будучи при этом напрямую зависимыми от
класса ```EventEmitter```.

2. Класс Api

Позволяет получать объект с сервера при запросе, работает с ответами сервера.
Класс имеет методы ```get``` и ```post``` для отправления и получения запросов на сервер.

## Компоненты модели данных (бизнес-логика)

1. Класс ApiShop

Реализует изменения данных для получения их в удобном ввиде.
Класс имеет методы ```getCardsArr```, ```getCardItem``` и ```postCard``` для отправки и получения ответов с сервера используя родительский класс ```Api```.

2. Класс AppState

Класс реализует работу с данными приложения.
Содержит обнуленные значения данных

```
basket: string[] = [];
catalog: ICard[];
order: IOrder = {
  email: '',
  phone: '',
  address: '',
  payment: '',
  total: 0,
  items: []
};

```

Имеет методы:
 ```setCatalog```, ```setBasket```, ```setOrderInfo``` - для сохранения данных.
 ```getOrder```, ```getBasket```, ```getCurrentCard``` - для получения сохраненных данных.
 ```clearBasket``` - дополнительный метод для работы с данными.

3. Функция renderCatalog

Преднозначена для создания экземпляров классов и последующей передачей в контейнер отображения в каталоге.

4. Функция handleOpenPopup

Эта функция открывает всплывающее окно с карточкой товара, используя переданный объект card типа IViewCard.

5. Функция handleOpenBasket 

Эта функция открывает всплышающее окно с корзиной товаров, дает возможность удалить из корзины товар или продолжить оформление.

6. Функция handleOpenForm

Эта функция сохроняет информацию о товарах в класс ```AppState```, также меняет на странице модальное окно, добовляя в него формы.

7. Функция handleOpenNextForm

Эта функция сохроняет информацию пользователя с предыдущей формы передовая ее в класс ```AppState```, также меняет на странице модальное окно, добовляя в него новые формы.

8. Функция handlePostOrder

Эта функция сохроняет информацию пользователя с предыдущей формы передовая ее в класс ```AppState```.
Делает отправку данных на сервер через класс ```ApiShop```.

9. Функция approvalOrder

Эта функция перерисовывает модальное окно говоря пользователю об успешной отправки данных на сервер.

## Компоненты представления

1. Класс Page

Выводит на страницу нужные визуальные элементы.
Навешивает слушатели на визуальные кнопки элементов страницы, используя родительский класс ```EventEmitter```.

Имеет методы:
```counter``` - для изменения счета товаров в корзине.
```catalogContainer```, ```popupContainer``` - для размещения элементов в контейнере.


2. Класс Card

Работает с ```Template``` элементами страницы, насышая контентом, устанавливает слушатели с помощью родительского класса.
Метод ```render``` получает информацию о продукте и возвращает готовый html-элемент.
Метод ```buyButtonView``` - для корректного отображения кнопки покупики.

3. Класс Basket

Класс для отоброжения содержимого корзины и последующей работы с ней.
Метод ```render``` для отоброжения всей корзины, принимет список элементов списка корзины, высчитывает общую стоимость товаров.

4. Класс Form

Класс для добавления форм в контейнер, считывания информации пользователя для дальнейшей передачи.
Реализует методы: 
```render``` - возвращает форм элемент, для дальнейшего использования.
```getOrderFromForm``` - отдает информацию о вводе пользователя после ```submit```.
```setOrderFromForm``` - внутреняя функция для сохранений информации пользователя после ```submit```.
```clearValue``` - функция для очистки форм, для последующего улучшения приложения.
```hasInvalidInput```, ```toggleButton```, ```cheackCashAndCardValid```,
```cheackInputValidation```, ```setForce```- внутрение методы формы для работы с валидацией input-элементов.

5. Класс approvalOrderView

Класс реализует работу с ```template``` элементами, для вывода конечной суммы, и подтверждения покупки пользователя.
Метод ```render``` возвращает измененный html-элемент страницы для последущего вывода.
